---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: proxmoxmachines.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    - proxmox
    kind: ProxmoxMachine
    listKind: ProxmoxMachineList
    plural: proxmoxmachines
    shortNames:
    - moxm
    singular: proxmoxmachine
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Cluster to which this ProxmoxMachine belongs
      jsonPath: .metadata.labels.cluster\.x-k8s\.io/cluster-name
      name: Cluster
      type: string
    - description: Machine ready status
      jsonPath: .status.ready
      name: Ready
      type: string
    - description: Proxmox Node that the machine was deployed on
      jsonPath: .status.proxmoxNode
      name: Node
      type: string
    - description: Provider ID
      jsonPath: .spec.providerID
      name: Provider_ID
      type: string
    - description: Machine object which owns with this ProxmoxMachine
      jsonPath: .metadata.ownerReferences[?(@.kind=="Machine")].name
      name: Machine
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: ProxmoxMachine is the Schema for the proxmoxmachines API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: ProxmoxMachineSpec defines the desired state of a ProxmoxMachine.
            properties:
              allowedNodes:
                description: |-
                  AllowedNodes specifies all Proxmox nodes which will be considered
                  for operations. This implies that VMs can be cloned on different nodes from
                  the node which holds the VM template.

                  This field is optional and should only be set if you want to restrict
                  the nodes where the VM can be cloned.
                  If not set, the ProxmoxCluster will be used to determine the nodes.
                items:
                  type: string
                type: array
              checks:
                description: Checks defines possibles checks to skip.
                properties:
                  skipCloudInitStatus:
                    description: Skip checking CloudInit which can be very useful
                      for specific Operating Systems like TalOS
                    type: boolean
                  skipQemuGuestAgent:
                    description: Skip checking QEMU Agent readiness which can be very
                      useful for specific Operating Systems like TalOS
                    type: boolean
                type: object
              description:
                description: Description for the new VM.
                type: string
              disks:
                description: |-
                  Disks contains a set of disk configuration options,
                  which will be applied before the first startup.
                properties:
                  bootVolume:
                    description: |-
                      BootVolume defines the storage size for the boot volume.
                      This field is optional, and should only be set if you want
                      to change the size of the boot volume.
                    properties:
                      disk:
                        description: |-
                          Disk is the name of the disk device, that should be resized.
                          Example values are: ide[0-3], scsi[0-30], sata[0-5].
                        type: string
                      sizeGb:
                        description: |-
                          Size defines the size in gigabyte.

                          As Proxmox does not support shrinking, the size
                          must be bigger than the already configured size in the
                          template.
                        format: int32
                        minimum: 5
                        type: integer
                    required:
                    - disk
                    - sizeGb
                    type: object
                    x-kubernetes-validations:
                    - message: Value is immutable
                      rule: self == oldSelf
                type: object
              format:
                description: Format for file storage. Only valid for full clone.
                enum:
                - raw
                - qcow2
                - vmdk
                type: string
              full:
                default: true
                description: |-
                  Full Create a full copy of all disks.
                  This is always done when you clone a normal VM.
                  Create a Full clone by default.
                type: boolean
              memoryMiB:
                description: |-
                  MemoryMiB is the size of a virtual machine's memory, in MiB.
                  Defaults to the property value in the template from which the virtual machine is cloned.
                format: int32
                multipleOf: 8
                type: integer
              metadataSettings:
                description: MetadataSettings defines the metadata settings for this
                  machine's VM.
                properties:
                  providerIDInjection:
                    description: |-
                      ProviderIDInjection enables the injection of the `providerID` into the cloudinit metadata.
                      this will basically set the `provider-id` field in the metadata to `proxmox://<instanceID>`.
                    type: boolean
                type: object
              network:
                description: Network is the network configuration for this machine's
                  VM.
                properties:
                  additionalDevices:
                    description: AdditionalDevices defines additional network devices
                      bound to the virtual machine.
                    items:
                      description: AdditionalNetworkDevice the definition of a Proxmox
                        network device.
                      properties:
                        bridge:
                          description: Bridge is the network bridge to attach to the
                            machine.
                          minLength: 1
                          type: string
                        dnsServers:
                          description: |-
                            DNSServers contains information about nameservers to be used for this interface.
                            If this field is not set, it will use the default dns servers from the ProxmoxCluster.
                          items:
                            type: string
                          minItems: 1
                          type: array
                        ipv4PoolRef:
                          description: |-
                            IPv4PoolRef is a reference to an IPAM Pool resource, which exposes IPv4 addresses.
                            The network device will use an available IP address from the referenced pool.
                            This can be combined with `IPv6PoolRef` in order to enable dual stack.
                          properties:
                            apiGroup:
                              description: |-
                                APIGroup is the group for the resource being referenced.
                                If APIGroup is not specified, the specified Kind must be in the core API group.
                                For any other third-party types, APIGroup is required.
                              type: string
                            kind:
                              description: Kind is the type of resource being referenced
                              type: string
                            name:
                              description: Name is the name of resource being referenced
                              type: string
                          required:
                          - kind
                          - name
                          type: object
                          x-kubernetes-map-type: atomic
                          x-kubernetes-validations:
                          - message: ipv4PoolRef allows only IPAM apiGroup ipam.cluster.x-k8s.io
                            rule: self.apiGroup == 'ipam.cluster.x-k8s.io'
                          - message: ipv4PoolRef allows either InClusterIPPool or
                              GlobalInClusterIPPool
                            rule: self.kind == 'InClusterIPPool' || self.kind == 'GlobalInClusterIPPool'
                        ipv6PoolRef:
                          description: |-
                            IPv6PoolRef is a reference to an IPAM pool resource, which exposes IPv6 addresses.
                            The network device will use an available IP address from the referenced pool.
                            this can be combined with `IPv4PoolRef` in order to enable dual stack.
                          properties:
                            apiGroup:
                              description: |-
                                APIGroup is the group for the resource being referenced.
                                If APIGroup is not specified, the specified Kind must be in the core API group.
                                For any other third-party types, APIGroup is required.
                              type: string
                            kind:
                              description: Kind is the type of resource being referenced
                              type: string
                            name:
                              description: Name is the name of resource being referenced
                              type: string
                          required:
                          - kind
                          - name
                          type: object
                          x-kubernetes-map-type: atomic
                          x-kubernetes-validations:
                          - message: ipv6PoolRef allows only IPAM apiGroup ipam.cluster.x-k8s.io
                            rule: self.apiGroup == 'ipam.cluster.x-k8s.io'
                          - message: ipv6PoolRef allows either InClusterIPPool or
                              GlobalInClusterIPPool
                            rule: self.kind == 'InClusterIPPool' || self.kind == 'GlobalInClusterIPPool'
                        linkMtu:
                          description: LinkMTU is the network device Maximum Transmission
                            Unit.
                          type: integer
                          x-kubernetes-validations:
                          - message: invalid MTU value
                            rule: self == 1 || ( self >= 576 && self <= 65520)
                        model:
                          default: virtio
                          description: Model is the network device model.
                          enum:
                          - e1000
                          - virtio
                          - rtl8139
                          - vmxnet3
                          type: string
                        mtu:
                          description: |-
                            MTU is the network device Maximum Transmission Unit.
                            When set to 1, virtio devices inherit the MTU value from the underlying bridge.
                          type: integer
                          x-kubernetes-validations:
                          - message: invalid MTU value
                            rule: self == 1 || ( self >= 576 && self <= 65520)
                        name:
                          description: |-
                            Name is the network device name.
                            Must be unique within the virtual machine and different from the primary device 'net0'.
                          minLength: 1
                          type: string
                          x-kubernetes-validations:
                          - message: additional network devices doesn't allow net0
                            rule: self != 'net0'
                        routes:
                          description: Routes are the routes associated with this
                            interface.
                          items:
                            description: RouteSpec describes an IPv4/IPv6 Route.
                            properties:
                              metric:
                                description: Metric is the priority of the route in
                                  the routing table.
                                format: int32
                                type: integer
                              table:
                                description: Table is the routing table used for this
                                  route.
                                format: int32
                                type: integer
                              to:
                                description: To is the subnet to be routed.
                                type: string
                              via:
                                description: Via is the gateway to the subnet.
                                type: string
                            type: object
                          minItems: 1
                          type: array
                        routingPolicy:
                          description: RoutingPolicy is an interface-specific policy
                            inserted into FIB (forwarding information base).
                          items:
                            description: RoutingPolicySpec is a Linux FIB rule.
                            properties:
                              from:
                                description: From is the subnet of the source.
                                type: string
                              priority:
                                description: Priority is the position in the ip rule
                                  FIB table.
                                format: int32
                                maximum: 4294967295
                                type: integer
                                x-kubernetes-validations:
                                - message: Cowardly refusing to insert FIB rule matching
                                    kernel rules
                                  rule: (self > 0 && self < 32765) || (self > 32766)
                              table:
                                description: |-
                                  Table is the routing table ID.
                                  when used in the networks, the value should be the VRF Table.
                                format: int32
                                type: integer
                              to:
                                description: To is the subnet of the target.
                                type: string
                            type: object
                          minItems: 1
                          type: array
                        vlan:
                          description: VLAN is the network L2 VLAN.
                          maximum: 4094
                          minimum: 1
                          type: integer
                      required:
                      - bridge
                      - name
                      type: object
                      x-kubernetes-validations:
                      - message: at least one pool reference must be set, either ipv4PoolRef
                          or ipv6PoolRef
                        rule: self.ipv4PoolRef != null || self.ipv6PoolRef != null
                    type: array
                    x-kubernetes-list-map-keys:
                    - name
                    x-kubernetes-list-type: map
                  default:
                    description: |-
                      Default is the default network device,
                      which will be used for the primary network interface.
                      net0 is always the default network device.
                    properties:
                      bridge:
                        description: Bridge is the network bridge to attach to the
                          machine.
                        minLength: 1
                        type: string
                      dnsServers:
                        description: |-
                          DNSServers contains information about nameservers to be used for this interface.
                          If this field is not set, it will use the default dns servers from the ProxmoxCluster.
                        items:
                          type: string
                        minItems: 1
                        type: array
                      ipv4PoolRef:
                        description: |-
                          IPv4PoolRef is a reference to an IPAM Pool resource, which exposes IPv4 addresses.
                          The network device will use an available IP address from the referenced pool.
                          This can be combined with `IPv6PoolRef` in order to enable dual stack.
                        properties:
                          apiGroup:
                            description: |-
                              APIGroup is the group for the resource being referenced.
                              If APIGroup is not specified, the specified Kind must be in the core API group.
                              For any other third-party types, APIGroup is required.
                            type: string
                          kind:
                            description: Kind is the type of resource being referenced
                            type: string
                          name:
                            description: Name is the name of resource being referenced
                            type: string
                        required:
                        - kind
                        - name
                        type: object
                        x-kubernetes-map-type: atomic
                        x-kubernetes-validations:
                        - message: ipv4PoolRef allows only IPAM apiGroup ipam.cluster.x-k8s.io
                          rule: self.apiGroup == 'ipam.cluster.x-k8s.io'
                        - message: ipv4PoolRef allows either InClusterIPPool or GlobalInClusterIPPool
                          rule: self.kind == 'InClusterIPPool' || self.kind == 'GlobalInClusterIPPool'
                      ipv6PoolRef:
                        description: |-
                          IPv6PoolRef is a reference to an IPAM pool resource, which exposes IPv6 addresses.
                          The network device will use an available IP address from the referenced pool.
                          this can be combined with `IPv4PoolRef` in order to enable dual stack.
                        properties:
                          apiGroup:
                            description: |-
                              APIGroup is the group for the resource being referenced.
                              If APIGroup is not specified, the specified Kind must be in the core API group.
                              For any other third-party types, APIGroup is required.
                            type: string
                          kind:
                            description: Kind is the type of resource being referenced
                            type: string
                          name:
                            description: Name is the name of resource being referenced
                            type: string
                        required:
                        - kind
                        - name
                        type: object
                        x-kubernetes-map-type: atomic
                        x-kubernetes-validations:
                        - message: ipv6PoolRef allows only IPAM apiGroup ipam.cluster.x-k8s.io
                          rule: self.apiGroup == 'ipam.cluster.x-k8s.io'
                        - message: ipv6PoolRef allows either InClusterIPPool or GlobalInClusterIPPool
                          rule: self.kind == 'InClusterIPPool' || self.kind == 'GlobalInClusterIPPool'
                      model:
                        default: virtio
                        description: Model is the network device model.
                        enum:
                        - e1000
                        - virtio
                        - rtl8139
                        - vmxnet3
                        type: string
                      mtu:
                        description: |-
                          MTU is the network device Maximum Transmission Unit.
                          When set to 1, virtio devices inherit the MTU value from the underlying bridge.
                        type: integer
                        x-kubernetes-validations:
                        - message: invalid MTU value
                          rule: self == 1 || ( self >= 576 && self <= 65520)
                      vlan:
                        description: VLAN is the network L2 VLAN.
                        maximum: 4094
                        minimum: 1
                        type: integer
                    required:
                    - bridge
                    type: object
                  vrfs:
                    description: Definition of a VRF Device.
                    items:
                      description: VRFDevice defines Virtual Routing Flow devices.
                      properties:
                        interfaces:
                          description: Interfaces is the list of proxmox network devices
                            managed by this virtual device.
                          items:
                            type: string
                          type: array
                        name:
                          description: |-
                            Name is the virtual network device name.
                            Must be unique within the virtual machine.
                          minLength: 3
                          type: string
                        routes:
                          description: Routes are the routes associated with this
                            interface.
                          items:
                            description: RouteSpec describes an IPv4/IPv6 Route.
                            properties:
                              metric:
                                description: Metric is the priority of the route in
                                  the routing table.
                                format: int32
                                type: integer
                              table:
                                description: Table is the routing table used for this
                                  route.
                                format: int32
                                type: integer
                              to:
                                description: To is the subnet to be routed.
                                type: string
                              via:
                                description: Via is the gateway to the subnet.
                                type: string
                            type: object
                          minItems: 1
                          type: array
                        routingPolicy:
                          description: RoutingPolicy is an interface-specific policy
                            inserted into FIB (forwarding information base).
                          items:
                            description: RoutingPolicySpec is a Linux FIB rule.
                            properties:
                              from:
                                description: From is the subnet of the source.
                                type: string
                              priority:
                                description: Priority is the position in the ip rule
                                  FIB table.
                                format: int32
                                maximum: 4294967295
                                type: integer
                                x-kubernetes-validations:
                                - message: Cowardly refusing to insert FIB rule matching
                                    kernel rules
                                  rule: (self > 0 && self < 32765) || (self > 32766)
                              table:
                                description: |-
                                  Table is the routing table ID.
                                  when used in the networks, the value should be the VRF Table.
                                format: int32
                                type: integer
                              to:
                                description: To is the subnet of the target.
                                type: string
                            type: object
                          minItems: 1
                          type: array
                        table:
                          description: Table is the ID of the routing table used for
                            the l3mdev vrf device.
                          format: int32
                          maximum: 4294967295
                          type: integer
                          x-kubernetes-validations:
                          - message: Cowardly refusing to insert l3mdev rules into
                              kernel tables
                            rule: (self > 0 && self < 254) || (self > 255)
                      required:
                      - name
                      - table
                      type: object
                    type: array
                    x-kubernetes-list-map-keys:
                    - name
                    x-kubernetes-list-type: map
                type: object
              numCores:
                description: |-
                  NumCores is the number of cores per CPU socket in a virtual machine.
                  Defaults to the property value in the template from which the virtual machine is cloned.
                format: int32
                minimum: 1
                type: integer
              numSockets:
                description: |-
                  NumSockets is the number of CPU sockets in a virtual machine.
                  Defaults to the property value in the template from which the virtual machine is cloned.
                format: int32
                minimum: 1
                type: integer
              pool:
                description: Pool Add the new VM to the specified pool.
                type: string
              providerID:
                description: |-
                  ProviderID is the virtual machine BIOS UUID formatted as
                  proxmox://6c3fa683-bef9-4425-b413-eaa45a9d6191
                type: string
              snapName:
                description: SnapName The name of the snapshot.
                type: string
              sourceNode:
                description: |-
                  SourceNode is the initially selected proxmox node.
                  This node will be used to locate the template VM, which will
                  be used for cloning operations.

                  Cloning will be performed according to the configuration.
                  Setting the `Target` field will tell Proxmox to clone the
                  VM on that target node.

                  When Target is not set and the ProxmoxCluster contains
                  a set of `AllowedNodes`, the algorithm will instead evenly
                  distribute the VMs across the nodes from that list.

                  If neither a `Target` nor `AllowedNodes` was set, the VM
                  will be cloned onto the same node as SourceNode.
                minLength: 1
                type: string
              storage:
                description: Storage for full clone.
                type: string
              tags:
                description: Tags is a list of tags to be applied to the virtual machine.
                items:
                  pattern: ^(?i)[a-z0-9_][a-z0-9_\-\+\.]*$
                  type: string
                minItems: 1
                type: array
                x-kubernetes-list-type: set
              target:
                description: Target node. Only allowed if the original VM is on shared
                  storage.
                type: string
              templateID:
                description: TemplateID the vm_template vmid used for cloning a new
                  VM.
                format: int32
                type: integer
              templateSelector:
                description: TemplateSelector defines MatchTags for looking up VM
                  templates.
                properties:
                  matchTags:
                    description: |-
                      Specifies all tags to look for, when looking up the VM template.
                      Passed tags must be an exact 1:1 match with the tags on the template you want to use.
                      If multiple VM templates with the same set of tags are found, provisioning will fail.
                    items:
                      pattern: ^(?i)[a-z0-9_][a-z0-9_\-\+\.]*$
                      type: string
                    minItems: 1
                    type: array
                    x-kubernetes-list-type: set
                required:
                - matchTags
                type: object
              virtualMachineID:
                description: VirtualMachineID is the Proxmox identifier for the ProxmoxMachine
                  VM.
                format: int64
                type: integer
              vmIDRange:
                description: VMIDRange is the range of VMIDs to use for VMs.
                properties:
                  end:
                    description: |-
                      VMIDRangeEnd is the end of the VMID range to use for VMs.
                      Only used if VMIDRangeStart is set.
                    format: int64
                    maximum: 999999999
                    minimum: 100
                    type: integer
                  start:
                    description: VMIDRangeStart is the start of the VMID range to
                      use for VMs.
                    format: int64
                    maximum: 999999999
                    minimum: 100
                    type: integer
                required:
                - end
                - start
                type: object
                x-kubernetes-validations:
                - message: end should be greater than or equal to start
                  rule: self.end >= self.start
            type: object
            x-kubernetes-validations:
            - message: must define either SourceNode with TemplateID, OR TemplateSelector
              rule: '[has(self.sourceNode), has(self.templateSelector)].exists_one(c,
                c)'
            - message: must define either SourceNode with TemplateID, OR TemplateSelector.
              rule: '[has(self.templateID), has(self.templateSelector)].exists_one(c,
                c)'
            - message: Must set full=true when specifying format
              rule: self.full || !has(self.format)
            - message: Must set full=true when specifying storage
              rule: self.full || !has(self.storage)
          status:
            description: ProxmoxMachineStatus defines the observed state of a ProxmoxMachine.
            properties:
              addresses:
                description: Addresses contains the Proxmox VM instance associated
                  addresses.
                items:
                  description: MachineAddress contains information for the node's
                    address.
                  properties:
                    address:
                      description: address is the machine address.
                      maxLength: 256
                      minLength: 1
                      type: string
                    type:
                      description: type is the machine address type, one of Hostname,
                        ExternalIP, InternalIP, ExternalDNS or InternalDNS.
                      enum:
                      - Hostname
                      - ExternalIP
                      - InternalIP
                      - ExternalDNS
                      - InternalDNS
                      type: string
                  required:
                  - address
                  - type
                  type: object
                type: array
              bootstrapDataProvided:
                description: BootstrapDataProvided whether the virtual machine has
                  an injected bootstrap data.
                type: boolean
              conditions:
                description: Conditions defines current service state of the ProxmoxMachine.
                items:
                  description: Condition defines an observation of a Cluster API resource
                    operational state.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed. If that is not known, then using the time when
                        the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This field may be empty.
                      maxLength: 10240
                      minLength: 1
                      type: string
                    reason:
                      description: |-
                        reason is the reason for the condition's last transition in CamelCase.
                        The specific API may choose whether or not this field is considered a guaranteed API.
                        This field may be empty.
                      maxLength: 256
                      minLength: 1
                      type: string
                    severity:
                      description: |-
                        severity provides an explicit classification of Reason code, so the users or machines can immediately
                        understand the current situation and act accordingly.
                        The Severity field MUST be set only when Status=False.
                      maxLength: 32
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      type: string
                    type:
                      description: |-
                        type of condition in CamelCase or in foo.example.com/CamelCase.
                        Many .condition.type values are consistent across resources like Available, but because arbitrary conditions
                        can be useful (see .node.status.conditions), the ability to deconflict is important.
                      maxLength: 256
                      minLength: 1
                      type: string
                  required:
                  - lastTransitionTime
                  - status
                  - type
                  type: object
                type: array
              failureMessage:
                description: |-
                  FailureMessage will be set in the event that there is a terminal problem
                  reconciling the Machine and will contain a more verbose string suitable
                  for logging and human consumption.

                  This field should not be set for transitive errors that a controller
                  faces that are expected to be fixed automatically over
                  time (like service outages), but instead indicate that something is
                  fundamentally wrong with the Machine's spec or the configuration of
                  the controller, and that manual intervention is required. Examples
                  of terminal errors would be invalid combinations of settings in the
                  spec, values that are unsupported by the controller, or the
                  responsible controller itself being critically misconfigured.

                  Any transient errors that occur during the reconciliation of ProxmoxMachines
                  can be added as events to the ProxmoxMachine object and/or logged in the
                  controller's output.
                type: string
              failureReason:
                description: |-
                  FailureReason will be set in the event that there is a terminal problem
                  reconciling the Machine and will contain a succinct value suitable
                  for machine interpretation.

                  This field should not be set for transitive errors that a controller
                  faces that are expected to be fixed automatically over
                  time (like service outages), but instead indicate that something is
                  fundamentally wrong with the Machine's spec or the configuration of
                  the controller, and that manual intervention is required. Examples
                  of terminal errors would be invalid combinations of settings in the
                  spec, values that are unsupported by the controller, or the
                  responsible controller itself being critically misconfigured.

                  Any transient errors that occur during the reconciliation of ProxmoxMachines
                  can be added as events to the ProxmoxMachine object and/or logged in the
                  controller's output.
                type: string
              ipAddresses:
                additionalProperties:
                  description: IPAddress defines the IP addresses of a network interface.
                  properties:
                    ipv4:
                      description: IPV4 is the IPv4 address.
                      type: string
                    ipv6:
                      description: IPV6 is the IPv6 address.
                      type: string
                  type: object
                description: IPAddresses are the IP addresses used to access the virtual
                  machine.
                type: object
              network:
                description: |-
                  Network returns the network status for each of the machine's configured.
                  network interfaces.
                items:
                  description: NetworkStatus provides information about one of a VM's
                    networks.
                  properties:
                    connected:
                      description: |-
                        Connected is a flag that indicates whether this network is currently
                        connected to the VM.
                      type: boolean
                    ipAddrs:
                      description: IPAddrs is one or more IP addresses reported by
                        vm-tools.
                      items:
                        type: string
                      type: array
                    macAddr:
                      description: MACAddr is the MAC address of the network device.
                      type: string
                    networkName:
                      description: NetworkName is the name of the network.
                      type: string
                  required:
                  - macAddr
                  type: object
                type: array
              proxmoxNode:
                description: |-
                  ProxmoxNode is the name of the proxmox node, which was chosen for this
                  machine to be deployed on.
                type: string
              ready:
                description: Ready indicates the Docker infrastructure has been provisioned
                  and is ready.
                type: boolean
              retryAfter:
                description: RetryAfter tracks the time we can retry queueing a task.
                format: date-time
                type: string
              taskRef:
                description: |-
                  TaskRef is a managed object reference to a Task related to the ProxmoxMachine.
                  This value is set automatically at runtime and should not be set or
                  modified by users.
                type: string
              vmStatus:
                description: VMStatus is used to identify the virtual machine status.
                type: string
            type: object
        type: object
    served: true
    storage: false
    subresources:
      status: {}
  - additionalPrinterColumns:
    - description: Cluster to which this ProxmoxMachine belongs
      jsonPath: .metadata.labels.cluster\.x-k8s\.io/cluster-name
      name: Cluster
      type: string
    - description: Machine ready status
      jsonPath: .status.ready
      name: Ready
      type: string
    - description: Proxmox Node that the machine was deployed on
      jsonPath: .status.proxmoxNode
      name: Node
      type: string
    - description: Provider ID
      jsonPath: .spec.providerID
      name: Provider_ID
      type: string
    - description: Machine object which owns with this ProxmoxMachine
      jsonPath: .metadata.ownerReferences[?(@.kind=="Machine")].name
      name: Machine
      type: string
    name: v1alpha2
    schema:
      openAPIV3Schema:
        description: ProxmoxMachine is the Schema for the proxmoxmachines API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec is the Proxmox machine spec.
            properties:
              allowedNodes:
                description: |-
                  allowedNodes specifies all Proxmox nodes which will be considered
                  for operations. This implies that VMs can be cloned on different nodes from
                  the node which holds the VM template.

                  This field is optional and should only be set if you want to restrict
                  the nodes where the VM can be cloned.
                  If not set, the ProxmoxCluster will be used to determine the nodes.
                items:
                  type: string
                type: array
                x-kubernetes-list-type: set
              checks:
                description: checks defines possibles checks to skip.
                properties:
                  skipCloudInitStatus:
                    description: skipCloudInitStatus skip checking CloudInit status
                      which can be useful with specific Operating Systems like TalOS
                    type: boolean
                  skipQemuGuestAgent:
                    description: skipQemuGuestAgent skips checking QEMU Agent readiness
                      which can be useful with specific Operating Systems like TalOS
                    type: boolean
                type: object
              description:
                description: description for the new VM.
                type: string
              disks:
                description: |-
                  disks contains a set of disk configuration options,
                  which will be applied before the first startup.
                properties:
                  bootVolume:
                    description: |-
                      bootVolume defines the storage size for the boot volume.
                      This field is optional, and should only be set if you want
                      to change the size of the boot volume.
                    properties:
                      disk:
                        description: |-
                          disk is the name of the disk device that should be resized.
                          Example values are: ide[0-3], scsi[0-30], sata[0-5].
                        minLength: 1
                        type: string
                      sizeGb:
                        description: |-
                          sizeGb defines the size in gigabytes.

                          As Proxmox does not support shrinking, the size
                          must be bigger than the already configured size in the
                          template.
                        format: int32
                        minimum: 5
                        type: integer
                    required:
                    - disk
                    - sizeGb
                    type: object
                    x-kubernetes-validations:
                    - message: Value is immutable
                      rule: self == oldSelf
                type: object
              format:
                description: format for file storage. Only valid for full clone.
                enum:
                - raw
                - qcow2
                - vmdk
                type: string
              full:
                default: true
                description: |-
                  full Create a full copy of all disks.
                  This is always done when you clone a normal VM.
                  Create a Full clone by default.
                type: boolean
              memoryMiB:
                description: |-
                  memoryMiB is the size of a virtual machine's memory, in MiB.
                  Defaults to the property value in the template from which the virtual machine is cloned.
                format: int32
                multipleOf: 8
                type: integer
              metadataSettings:
                description: metadataSettings defines the metadata settings for this
                  machine's VM.
                properties:
                  providerIDInjection:
                    description: |-
                      providerIDInjection enables the injection of the `providerID` into the cloudinit metadata.
                      this will basically set the `provider-id` field in the metadata to `proxmox://<instanceID>`.
                    type: boolean
                required:
                - providerIDInjection
                type: object
              network:
                description: network is the network configuration for this machine's
                  VM.
                properties:
                  networkDevices:
                    description: |-
                      networkDevices lists network devices.
                      net0 is always the default device.
                    items:
                      description: NetworkDevice defines the required details of a
                        virtual machine network device.
                      properties:
                        bridge:
                          description: bridge is the network bridge to attach to the
                            machine.
                          minLength: 1
                          type: string
                        defaultIPv4:
                          description: defaultIPv4 attaches the ipv4 host network
                            to this interface.
                          type: boolean
                        defaultIPv6:
                          description: defaultIPv6 attaches the ipv6 host network
                            to this interface.
                          type: boolean
                        dnsServers:
                          description: |-
                            dnsServers contains information about nameservers to be used for this interface.
                            If this field is not set, it will use the default dns servers from the ProxmoxCluster.
                          items:
                            type: string
                          minItems: 1
                          type: array
                          x-kubernetes-list-type: set
                        ipPoolRef:
                          description: |-
                            ipPoolRef is a reference to an IPAM Pool resource, which exposes IPv4 addresses.
                            The network device will use an available IP address from the referenced pool.
                            This can be combined with `IPv6PoolRef` in order to enable dual stack.
                          items:
                            description: |-
                              TypedLocalObjectReference contains enough information to let you locate the
                              typed referenced object inside the same namespace.
                            properties:
                              apiGroup:
                                description: |-
                                  APIGroup is the group for the resource being referenced.
                                  If APIGroup is not specified, the specified Kind must be in the core API group.
                                  For any other third-party types, APIGroup is required.
                                type: string
                              kind:
                                description: Kind is the type of resource being referenced
                                type: string
                              name:
                                description: Name is the name of resource being referenced
                                type: string
                            required:
                            - kind
                            - name
                            type: object
                            x-kubernetes-map-type: atomic
                            x-kubernetes-validations:
                            - message: ipPoolRef allows only IPAM apiGroup ipam.cluster.x-k8s.io
                              rule: self.apiGroup == 'ipam.cluster.x-k8s.io'
                            - message: ipPoolRef allows either InClusterIPPool or
                                GlobalInClusterIPPool
                              rule: self.kind == 'InClusterIPPool' || self.kind ==
                                'GlobalInClusterIPPool'
                          type: array
                          x-kubernetes-list-type: atomic
                        linkMtu:
                          description: linkMtu is the network device Maximum Transmission
                            Unit.
                          format: int32
                          type: integer
                          x-kubernetes-validations:
                          - message: invalid MTU value
                            rule: self == 1 || (self >= 576 && self <= 65520)
                        model:
                          default: virtio
                          description: model is the network device model.
                          enum:
                          - e1000
                          - virtio
                          - rtl8139
                          - vmxnet3
                          type: string
                        mtu:
                          description: |-
                            mtu is the network device Maximum Transmission Unit.
                            When set to 1, virtio devices inherit the MTU value from the underlying bridge.
                          format: int32
                          type: integer
                          x-kubernetes-validations:
                          - message: invalid MTU value
                            rule: self == 1 || (self >= 576 && self <= 65520)
                        name:
                          default: net0
                          description: name is the network device name.
                          minLength: 4
                          pattern: ^net[0-9]+$
                          type: string
                        routes:
                          description: routes are the routes associated with this
                            interface.
                          items:
                            description: RouteSpec describes an IPv4/IPv6 Route.
                            properties:
                              metric:
                                description: metric is the priority of the route in
                                  the routing table.
                                format: int32
                                minimum: 0
                                type: integer
                              table:
                                description: table is the routing table used for this
                                  route.
                                format: int32
                                type: integer
                              to:
                                description: to is the subnet to be routed.
                                type: string
                              via:
                                description: via is the gateway to the subnet.
                                type: string
                            type: object
                          minItems: 1
                          type: array
                          x-kubernetes-list-type: atomic
                        routingPolicy:
                          description: routingPolicy is an interface-specific policy
                            inserted into FIB (forwarding information base).
                          items:
                            description: RoutingPolicySpec is a Linux FIB rule.
                            properties:
                              from:
                                description: from is the subnet of the source.
                                type: string
                              priority:
                                description: priority is the position in the ip rule
                                  FIB table.
                                format: int64
                                maximum: 4294967295
                                type: integer
                                x-kubernetes-validations:
                                - message: Cowardly refusing to insert FIB rule matching
                                    kernel rules
                                  rule: (self > 0 && self < 32765) || (self > 32766)
                              table:
                                description: table is the routing table ID.
                                format: int32
                                type: integer
                              to:
                                description: to is the subnet of the target.
                                type: string
                            type: object
                          minItems: 1
                          type: array
                          x-kubernetes-list-type: atomic
                        vlan:
                          description: vlan is the network L2 VLAN.
                          format: int32
                          maximum: 4094
                          minimum: 1
                          type: integer
                      required:
                      - name
                      type: object
                    type: array
                    x-kubernetes-list-map-keys:
                    - name
                    x-kubernetes-list-type: map
                  vrfs:
                    description: vrfs defines VRF Devices.
                    items:
                      description: VRFDevice defines Virtual Routing Flow devices.
                      properties:
                        interfaces:
                          description: interfaces is the list of proxmox network devices
                            managed by this virtual device.
                          items:
                            description: NetName is a formally verified Proxmox network
                              name string.
                            minLength: 4
                            pattern: ^net[0-9]+$
                            type: string
                          type: array
                          x-kubernetes-list-type: atomic
                        name:
                          description: |-
                            name is the virtual network device name.
                            Must be unique within the virtual machine.
                          minLength: 3
                          type: string
                        routes:
                          description: routes are the routes associated with this
                            interface.
                          items:
                            description: RouteSpec describes an IPv4/IPv6 Route.
                            properties:
                              metric:
                                description: metric is the priority of the route in
                                  the routing table.
                                format: int32
                                minimum: 0
                                type: integer
                              table:
                                description: table is the routing table used for this
                                  route.
                                format: int32
                                type: integer
                              to:
                                description: to is the subnet to be routed.
                                type: string
                              via:
                                description: via is the gateway to the subnet.
                                type: string
                            type: object
                          minItems: 1
                          type: array
                          x-kubernetes-list-type: atomic
                        routingPolicy:
                          description: routingPolicy is an interface-specific policy
                            inserted into FIB (forwarding information base).
                          items:
                            description: RoutingPolicySpec is a Linux FIB rule.
                            properties:
                              from:
                                description: from is the subnet of the source.
                                type: string
                              priority:
                                description: priority is the position in the ip rule
                                  FIB table.
                                format: int64
                                maximum: 4294967295
                                type: integer
                                x-kubernetes-validations:
                                - message: Cowardly refusing to insert FIB rule matching
                                    kernel rules
                                  rule: (self > 0 && self < 32765) || (self > 32766)
                              table:
                                description: table is the routing table ID.
                                format: int32
                                type: integer
                              to:
                                description: to is the subnet of the target.
                                type: string
                            type: object
                          minItems: 1
                          type: array
                          x-kubernetes-list-type: atomic
                        table:
                          description: table is the ID of the routing table used for
                            the l3mdev vrf device.
                          format: int32
                          maximum: 4294967295
                          minimum: 1
                          type: integer
                          x-kubernetes-validations:
                          - message: Cowardly refusing to insert l3mdev rules into
                              kernel tables
                            rule: (self > 0 && self < 254) || (self > 255)
                      required:
                      - name
                      - table
                      type: object
                    type: array
                    x-kubernetes-list-map-keys:
                    - name
                    x-kubernetes-list-type: map
                  zone:
                    description: zone is the cluster deployment zone this machine
                      will refer to.
                    pattern: ^[a-z0-9A-Z](?:[a-z0-9A-Z-_.]{0,61}[a-z0-9A-Z])?$
                    type: string
                type: object
              numCores:
                description: |-
                  numCores is the number of cores per CPU socket in a virtual machine.
                  Defaults to the property value in the template from which the virtual machine is cloned.
                format: int32
                minimum: 1
                type: integer
              numSockets:
                description: |-
                  numSockets is the number of CPU sockets in a virtual machine.
                  Defaults to the property value in the template from which the virtual machine is cloned.
                format: int32
                minimum: 1
                type: integer
              pool:
                description: pool Add the new VM to the specified pool.
                type: string
              providerID:
                description: |-
                  providerID is the virtual machine BIOS UUID formatted as
                  proxmox://6c3fa683-bef9-4425-b413-eaa45a9d6191
                type: string
              snapName:
                description: snapName The name of the snapshot.
                type: string
              sourceNode:
                description: |-
                  sourceNode is the initially selected proxmox node.
                  This node will be used to locate the template VM, which will
                  be used for cloning operations.

                  Cloning will be performed according to the configuration.
                  Setting the `Target` field will tell Proxmox to clone the
                  VM on that target node.

                  When Target is not set and the ProxmoxCluster contains
                  a set of `AllowedNodes`, the algorithm will instead evenly
                  distribute the VMs across the nodes from that list.

                  If neither a `Target` nor `AllowedNodes` was set, the VM
                  will be cloned onto the same node as SourceNode.
                minLength: 1
                type: string
              storage:
                description: storage for full clone.
                type: string
              tags:
                description: tags is a list of tags to be applied to the virtual machine.
                items:
                  pattern: ^(?i)[a-z0-9_][a-z0-9_\-\+\.]*$
                  type: string
                minItems: 1
                type: array
                x-kubernetes-list-type: set
              target:
                description: target node. Only allowed if the original VM is on shared
                  storage.
                type: string
              templateID:
                description: templateID the vm_template vmid used for cloning a new
                  VM.
                format: int32
                type: integer
              templateSelector:
                description: templateSelector defines MatchTags for looking up VM
                  templates.
                properties:
                  matchTags:
                    description: |-
                      matchTags specifies all tags to look for when looking up the VM template.
                      Passed tags must be an exact 1:1 match with the tags on the template you want to use.
                      If multiple VM templates with the same set of tags are found, provisioning will fail.
                    items:
                      pattern: ^(?i)[a-z0-9_][a-z0-9_\-\+\.]*$
                      type: string
                    minItems: 1
                    type: array
                    x-kubernetes-list-type: set
                required:
                - matchTags
                type: object
              virtualMachineID:
                description: virtualMachineID is the Proxmox identifier for the ProxmoxMachine
                  VM.
                format: int64
                type: integer
              vmIDRange:
                description: vmIDRange is the range of VMIDs to use for VMs.
                properties:
                  end:
                    description: |-
                      end is the end of the VMID range to use for VMs.
                      Only used if VMIDRangeStart is set.
                    format: int64
                    maximum: 999999999
                    minimum: 100
                    type: integer
                  start:
                    description: start is the start of the VMID range to use for VMs.
                    format: int64
                    maximum: 999999999
                    minimum: 100
                    type: integer
                required:
                - end
                - start
                type: object
                x-kubernetes-validations:
                - message: end should be greater than or equal to start
                  rule: self.end >= self.start
            type: object
            x-kubernetes-validations:
            - message: must define either a SourceNode with a TemplateID or a TemplateSelector
              rule: '[has(self.sourceNode), has(self.templateSelector)].exists_one(c,
                c)'
            - message: must define either a SourceNode with a TemplateID or a TemplateSelector
              rule: '[has(self.templateID), has(self.templateSelector)].exists_one(c,
                c)'
            - message: Must set full=true when specifying format
              rule: self.full || !has(self.format)
            - message: Must set full=true when specifying storage
              rule: self.full || !has(self.storage)
          status:
            description: status is the status of the Proxmox machine.
            properties:
              addresses:
                description: addresses contains the Proxmox VM instance associated
                  addresses.
                items:
                  description: MachineAddress contains information for the node's
                    address.
                  properties:
                    address:
                      description: address is the machine address.
                      maxLength: 256
                      minLength: 1
                      type: string
                    type:
                      description: type is the machine address type, one of Hostname,
                        ExternalIP, InternalIP, ExternalDNS or InternalDNS.
                      enum:
                      - Hostname
                      - ExternalIP
                      - InternalIP
                      - ExternalDNS
                      - InternalDNS
                      type: string
                  required:
                  - address
                  - type
                  type: object
                type: array
                x-kubernetes-list-type: atomic
              bootstrapDataProvided:
                description: bootstrapDataProvided whether the virtual machine has
                  an injected bootstrap data.
                type: boolean
              conditions:
                description: conditions defines current service state of the ProxmoxMachine.
                items:
                  description: Condition defines an observation of a Cluster API resource
                    operational state.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed. If that is not known, then using the time when
                        the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This field may be empty.
                      maxLength: 10240
                      minLength: 1
                      type: string
                    reason:
                      description: |-
                        reason is the reason for the condition's last transition in CamelCase.
                        The specific API may choose whether or not this field is considered a guaranteed API.
                        This field may be empty.
                      maxLength: 256
                      minLength: 1
                      type: string
                    severity:
                      description: |-
                        severity provides an explicit classification of Reason code, so the users or machines can immediately
                        understand the current situation and act accordingly.
                        The Severity field MUST be set only when Status=False.
                      maxLength: 32
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      type: string
                    type:
                      description: |-
                        type of condition in CamelCase or in foo.example.com/CamelCase.
                        Many .condition.type values are consistent across resources like Available, but because arbitrary conditions
                        can be useful (see .node.status.conditions), the ability to deconflict is important.
                      maxLength: 256
                      minLength: 1
                      type: string
                  required:
                  - lastTransitionTime
                  - status
                  - type
                  type: object
                type: array
              failureMessage:
                description: |-
                  failureMessage will be set in the event that there is a terminal problem
                  reconciling the Machine and will contain a more verbose string suitable
                  for logging and human consumption.

                  This field should not be set for transitive errors that a controller
                  faces that are expected to be fixed automatically over
                  time (like service outages), but instead indicate that something is
                  fundamentally wrong with the Machine's spec or the configuration of
                  the controller, and that manual intervention is required. Examples
                  of terminal errors would be invalid combinations of settings in the
                  spec, values that are unsupported by the controller, or the
                  responsible controller itself being critically misconfigured.

                  Any transient errors that occur during the reconciliation of ProxmoxMachines
                  can be added as events to the ProxmoxMachine object and/or logged in the
                  controller's output.
                type: string
              failureReason:
                description: |-
                  failureReason will be set in the event that there is a terminal problem
                  reconciling the Machine and will contain a succinct value suitable
                  for machine interpretation.

                  This field should not be set for transitive errors that a controller
                  faces that are expected to be fixed automatically over
                  time (like service outages), but instead indicate that something is
                  fundamentally wrong with the Machine's spec or the configuration of
                  the controller, and that manual intervention is required. Examples
                  of terminal errors would be invalid combinations of settings in the
                  spec, values that are unsupported by the controller, or the
                  responsible controller itself being critically misconfigured.

                  Any transient errors that occur during the reconciliation of ProxmoxMachines
                  can be added as events to the ProxmoxMachine object and/or logged in the
                  controller's output.
                type: string
              ipAddresses:
                description: ipAddresses are the IP addresses used to access the virtual
                  machine.
                items:
                  description: IPAddressesSpec stores the IP addresses of a network
                    interface. Used for status.
                  properties:
                    ipv4:
                      description: ipv4 is the IPv4 address.
                      items:
                        type: string
                      type: array
                      x-kubernetes-list-type: set
                    ipv6:
                      description: ipv6 is the IPv6 address.
                      items:
                        type: string
                      type: array
                      x-kubernetes-list-type: set
                    net:
                      description: net is the proxmox network name these ipaddresses
                        are attached to.
                      minLength: 1
                      pattern: ^(net[0-9]+|default)$
                      type: string
                  required:
                  - net
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - net
                x-kubernetes-list-type: map
              network:
                description: |-
                  network returns the network status for each of the machine's configured.
                  network interfaces.
                items:
                  description: NetworkStatus provides information about one of a VM's
                    networks.
                  properties:
                    connected:
                      description: |-
                        connected is a flag that indicates whether this network is currently
                        connected to the VM.
                      type: boolean
                    ipAddrs:
                      description: ipAddrs is one or more IP addresses reported by
                        vm-tools.
                      items:
                        type: string
                      type: array
                      x-kubernetes-list-type: set
                    macAddr:
                      description: macAddr is the MAC address of the network device.
                      maxLength: 17
                      minLength: 17
                      pattern: ^([0-9A-Fa-f]{2}[:]){5}([0-9A-Fa-f]{2})$
                      type: string
                    networkName:
                      description: networkName is the name of the network.
                      minLength: 4
                      pattern: ^net[0-9]+$
                      type: string
                  required:
                  - connected
                  - macAddr
                  type: object
                type: array
                x-kubernetes-list-type: atomic
              proxmoxNode:
                description: |-
                  proxmoxNode is the name of the proxmox node, which was chosen for this
                  machine to be deployed on.
                type: string
              ready:
                description: ready indicates the Docker infrastructure has been provisioned
                  and is ready.
                type: boolean
              retryAfter:
                description: retryAfter tracks the time we can retry queueing a task.
                format: date-time
                type: string
              taskRef:
                description: |-
                  taskRef is a managed object reference to a Task related to the ProxmoxMachine.
                  This value is set automatically at runtime and should not be set or
                  modified by users.
                type: string
              vmStatus:
                description: vmStatus is used to identify the virtual machine status.
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
